# ДЗ 2

### Author:
- Ионов Тимур Русланович

### Task:
- multiclass classification

### Dataset:
- Fashion MNIST

### Classes:
- T-shirt/top
- Trouser
- Pullover
- Dress
- Coat
- Sandal
- Shirt
- Sneaker
- Bag
- Ankle boot


### Augmentations:
- RandomHorizontalFlip() 
- RandomVerticalFlip()
- RandomRotation(90)

### Architectures (customized):
- SimpleCNN
- [SpatialAttentionCNN](https://arxiv.org/abs/1807.06521v2)  (sa)
- [GatedCNN](https://arxiv.org/abs/1612.08083v3)


### Hyperparameters: 
- optimizer: AdamW
- learning rate: 3e-4
- max epochs: 100
- batch size: 64

### Losses:
- CrossEntropy


### Goals:

Целью данного эксперимента было оценить и сравнить эффективность трех различных архитектур сверточных нейронных сетей: обычной CNN (SimpleCNN), CNN с пространственным вниманием (SpatialAttentionCNN) и CNN с gated convolution блоками (GatedCNN) в задаче классификации на датасете Fashion MNIST. Основная цель - улучшить ключевые метрики классификации (точность, полноту, F1-меру) и оценить, как различные модификации архитектур влияют на процесс обучения и итоговую производительность моделей.

### Ideas:

Эксперименты былы направлены на изучение влияния различных архитектурных подходов в сверточных нейронных сетях на задачу классификации изображений:
- SimpleCNN: Стандартная архитектура сверточной нейронной сети - baseline.
- SpatialAttentionCNN: Архитектура с внедрением механизма пространственного внимания, который позволяет модели фокусироваться на ключевых областях изображений.
- GatedCNN: Архитектура с использованием gated convolutions, что обеспечивает дополнительный контроль потока информации и фильтрацию признаков.

### Metrics:
![image](assets/tensorboard.jpg)

Column prefix is model name 

| Категория   | simple_Precision | simple_Recall | simple_F1 | sa_Precision | sa_Recall | sa_F1 | gated_Precision | gated_Recall | gated_F1 |
|-------------|------------------|---------------|-----------|--------------|-----------|-------|-----------------|--------------|----------|
| T-shirt/top | 0.824            | 0.824         | 0.824     | 0.862        | 0.862     | 0.862 | 0.865           | 0.865        | 0.865    |
| Trouser     | 0.978            | 0.978         | 0.978     | 0.969        | 0.969     | 0.969 | 0.979           | 0.979        | 0.979    |
| Pullover    | 0.852            | 0.852         | 0.852     | 0.892        | 0.892     | 0.892 | 0.842           | 0.842        | 0.842    |
| Dress       | 0.895            | 0.895         | 0.895     | 0.884        | 0.884     | 0.884 | 0.835           | 0.835        | 0.835    |
| Coat        | 0.872            | 0.872         | 0.872     | 0.821        | 0.821     | 0.821 | 0.921           | 0.921        | 0.921    |
| Sandal      | 0.957            | 0.957         | 0.957     | 0.924        | 0.924     | 0.924 | 0.955           | 0.955        | 0.955    |
| Shirt       | 0.653            | 0.653         | 0.653     | 0.671        | 0.671     | 0.671 | 0.656           | 0.656        | 0.656    |
| Sneaker     | 0.969            | 0.969         | 0.969     | 0.968        | 0.968     | 0.968 | 0.949           | 0.949        | 0.949    |
| Bag         | 0.976            | 0.976         | 0.976     | 0.960        | 0.960     | 0.960 | 0.960           | 0.960        | 0.960    |
| Ankle boot  | 0.955            | 0.955         | 0.955     | 0.957        | 0.957     | 0.957 | 0.966           | 0.966        | 0.966    |

### Results:

Из результатов эксперимента следует, что модель GatedCNN превосходит остальные архитектуры по всем основным метрикам (точность, полнота, F1-мера) на большинстве классов Fashion MNIST. SpatialAttentionCNN также показывает улучшение по сравнению с SimpleCNN, но не достигает показателей GatedCNN.
Выводы:

- SimpleCNN, будучи базовой моделью, показывает неплохие результаты, однако ограничена в своей способности выделять сложные признаки.
- SpatialAttentionCNN улучшает производительность за счет фокусировки на важных областях изображения, что делает ее более эффективной по сравнению с базовой моделью.
- GatedCNN демонстрирует наилучшие результаты, что может быть обусловлено эффективной фильтрацией и передачей признаков через слои сети. Это подтверждает гипотезу о том, что дополнительные механизмы регуляризации и контроля потока информации могут существенно улучшить производительность модели в задачах с высокой вариативностью внутри классов, как в случае с Fashion MNIST.


### Debug plot:
#### simple:
![image](assets/simple_pred.jpg)

#### spatial attention:
![image](assets/sa_pred.jpg)

#### gated:
![image](assets/gated_pred.jpg)
